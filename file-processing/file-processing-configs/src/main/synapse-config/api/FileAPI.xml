<?xml version="1.0" encoding="UTF-8"?>
<api context="/files" name="FileAPI" xmlns="http://ws.apache.org/ns/synapse">
    <resource methods="POST" uri-template="/move/{source}/{destination}">
        <inSequence>
            <propertyGroup>
                <property expression="get-property('uri.var.source')" name="source" scope="default" type="STRING"/>
                <property expression="get-property('uri.var.destination')" name="destination" scope="default" type="STRING"/>
            </propertyGroup>
            <log>
                <property name="Message" value="Trigger sequence to process file ..."/>
                <property expression="$ctx:source" name="Source"/>
                <property expression="$ctx:destination" name="Destination"/>
            </log>
            <sequence key="{fn:concat('main_',$ctx:source,'_to_',$ctx:destination,'_seq')}"/>
        </inSequence>
        <outSequence/>
        <faultSequence/>
    </resource>
    <resource methods="POST" uri-template="/sequence/{sequence_name}">
        <inSequence>
            <propertyGroup>
                <property expression="get-property('uri.var.sequence_name')" name="sequenceName" scope="default" type="STRING"/>
            </propertyGroup>
            <log>
                <property name="Message" value="Trigger specific sequence by name"/>
                <property expression="$ctx:sequenceName" name="Sequence"/>
            </log>
            <sequence key="{$ctx:sequenceName}"/>
        </inSequence>
        <outSequence/>
        <faultSequence/>
    </resource>
</api>
